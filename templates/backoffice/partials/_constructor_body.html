<div class="lg:col-span-3 mb-2">...</div>
<div class="lg:col-span-2 space-y-6">...</div>

<div class="lg:col-span-1">
    <div class="bg-white border border-gray-200 rounded-lg p-6 h-full flex flex-col shadow-sm">
        
        <div class="flex justify-between items-center mb-4 pb-4 border-b border-gray-100">
            <h2 class="text-gray-800 text-lg font-bold">Banco de Preguntas</h2>
            <span class="bg-gray-100 text-gray-600 text-xs px-2 py-1 rounded-full font-semibold border border-gray-200">
                {{ bank_items_count }} Disponibles
            </span>
        </div>

        <div class="space-y-3 flex-1 overflow-y-auto custom-scrollbar pr-1" style="max-height: 600px;">
            {% for item in bank_items %}
            <div class="p-3 rounded-lg border transition-all duration-200 group relative flex items-start gap-2
                        {% if item.source_tag == 'generated' %} bg-green-50 border-green-200 shadow-sm
                        {% elif item.source_tag == 'found' %} bg-blue-50 border-blue-200 shadow-sm
                        {% else %} bg-white border-gray-200 hover:border-blue-400 hover:shadow-md {% endif %}">
                
                <div class="flex-1 min-w-0">
                    <div class="flex items-center gap-2 mb-1.5">
                        {% if item.source_tag == 'generated' %}
                            <span class="text-[9px] uppercase tracking-wider bg-green-100 text-green-700 px-1.5 py-0.5 rounded-sm font-bold">Nueva</span>
                        {% endif %}
                        <span class="text-[9px] uppercase tracking-wider text-gray-500 bg-gray-100 px-1.5 py-0.5 rounded-sm border border-gray-200">
                            {{ item.get_item_type_display }}
                        </span>
                    </div>

                    {% if item.tags %}
                    <div class="mb-1">
                        <span class="text-[9px] bg-indigo-50 text-indigo-600 px-1 py-0.5 rounded border border-indigo-100 truncate max-w-[120px] inline-block">
                            {{ item.tags }}
                        </span>
                    </div>
                    {% endif %}

                    <p class="text-gray-700 text-xs leading-relaxed font-medium line-clamp-3 group-hover:line-clamp-none transition-all duration-300">
                        {{ item.stem }}
                    </p>
                </div>

                <button hx-post="{% url 'backoffice:add_item_to_exam' exam.id item.id %}"
                        hx-target="#constructor-body"
                        class="flex-shrink-0 w-7 h-7 flex items-center justify-center rounded-full border mt-1
                               {% if item.source_tag == 'generated' %} border-green-300 text-green-600 bg-green-100 hover:bg-green-200
                               {% else %} border-gray-200 text-blue-600 bg-gray-50 hover:bg-blue-600 hover:text-white hover:border-blue-600 {% endif %}
                               transition-all shadow-sm z-10"
                        title="Agregar al examen">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                    </svg>
                </button>
            </div>
            {% empty %}
                <div class="text-center py-12 opacity-60">
                    <p class="text-gray-400 text-sm">No hay m√°s preguntas en el banco.</p>
                </div>
            {% endfor %}
        </div>
    </div>
</div>

<button onclick="window.scrollTo({top: 0, behavior: 'smooth'})" 
        class="fixed bottom-8 right-8 bg-slate-800 text-white p-3 rounded-full shadow-lg hover:bg-slate-700 transition-all z-50 border border-slate-600 opacity-80 hover:opacity-100"
        title="Ir Arriba">
    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"></path></svg>
</button>
